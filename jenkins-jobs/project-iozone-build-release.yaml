---
- project:
    build_what: 'iozone'
    name: 'project-build-release'
    distro:
      - 'rhel8.8':
          version: '3.494-1.fc38'
          dist: 'el8'
    jobs:
      - '{name}-{build_what}-{distro}'

- job-template:
    name: '{name}-{build_what}-{distro}'
    node: 'build-agent-{distro}'

    # default var values
    arch: 'aarch64'
    dist: '{distro}'

    parameters:
      - string:
          name: 'DISTRO'
          default: '{distro}'
          description: 'Distro version to build, e.g.: rhel8.8'
      - string:
          name: 'VERSION'
          default: '{version}'
          description: '{build_what} version to build, e.g.: 3.494-1.fc38
            see https://rpmfind.net/linux/rpm2html/search.php?query=iozone&submit=Search+...&system=&arch=aarch64'

    builders:
      - shell:
          !include-raw-escape: scripts/build-{build_what}-release.sh
    publishers:
      - groovy-postbuild:
          script: |
            def summary = manager.createSummary("package.gif")
            summary.appendText("See <a href=https://uk.linaro.cloud/repo/{build_what}/{dist}/{arch}/>RPM release repo.</a>", false)
